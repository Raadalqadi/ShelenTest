"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[82],{130:(e,s,t)=>{t.d(s,{T:()=>a});const a=""},4894:(e,s,t)=>{t.d(s,{A:()=>r});var a=t(579);const r=()=>(0,a.jsx)("svg",{width:"20",height:"12",viewBox:"0 0 20 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M19.5598 0.458879C19.2778 0.165059 18.8954 0 18.4967 0C18.098 0 17.7157 0.165059 17.4337 0.458879L9.99092 8.21692L2.54815 0.458879C2.26457 0.173386 1.88476 0.0154123 1.49052 0.0189838C1.09629 0.0225544 0.719168 0.187384 0.44039 0.47797C0.161613 0.768557 0.00348282 1.16165 5.72205e-05 1.57259C-0.00336838 1.98352 0.148186 2.37942 0.422075 2.67501L8.92789 11.5411C9.20985 11.8349 9.59222 12 9.99092 12C10.3896 12 10.772 11.8349 11.054 11.5411L19.5598 2.67501C19.8416 2.3811 20 1.98253 20 1.56695C20 1.15136 19.8416 0.752788 19.5598 0.458879Z",fill:"#2B2B2B"})})},5082:(e,s,t)=>{t.r(s),t.d(s,{default:()=>u});var a=t(7127),r=t(5043),n=t(6213),l=t(579);const o=()=>(0,l.jsxs)("svg",{width:"68",height:"68",viewBox:"0 0 68 68",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("rect",{width:"68",height:"68",rx:"34",fill:"#81A220"}),(0,l.jsx)("path",{d:"M19.6239 44.8945H23.2479V52.3549L32.4907 44.8945H41.3675C43.3661 44.8945 44.9915 43.2547 44.9915 41.2383V26.6135C44.9915 24.5971 43.3661 22.9573 41.3675 22.9573H19.6239C17.6253 22.9573 16 24.5971 16 26.6135V41.2383C16 43.2547 17.6253 44.8945 19.6239 44.8945Z",fill:"#FCFCFC"}),(0,l.jsx)("path",{d:"M48.6156 15.645H26.872C24.8734 15.645 23.248 17.2848 23.248 19.3012H44.9916C46.9902 19.3012 48.6156 20.941 48.6156 22.9574V37.5821C50.6142 37.5821 52.2395 35.9423 52.2395 33.926V19.3012C52.2395 17.2848 50.6142 15.645 48.6156 15.645Z",fill:"#FCFCFC"})]});t(8252);var i=t(9712),c=t(130),h=t(4894);const u=()=>{const[e,s]=(0,r.useState)(null),[t,u]=(0,r.useState)([]),[d,g]=(0,r.useState)(""),[,m]=(0,r.useState)(!1),[p,x]=(0,r.useState)(""),C=(0,r.useRef)(null),[w,f]=(0,r.useState)(),[j,v]=(0,r.useState)(!1);(0,r.useEffect)((()=>{try{if(localStorage.getItem("bank_Auth")){const e=JSON.parse(localStorage.getItem("bank_Auth")||"");f(e),x(e.username)}else n.A.post(`${c.T}/api/MessageUser/generate-random-user`).then((e=>{e.data&&(localStorage.setItem("bank_Auth",JSON.stringify(e.data.user)),x(e.data.user.username),f(e.data.user))}))}catch{}}),[]),(0,r.useEffect)((()=>{try{if(p){n.A.get(`${c.T}/api/MessageUser/messages?username=${w.username}&password=${w.password}`).then((e=>{const s=e.data.messages.map((e=>({user:"user"===e.sender_type?"user":"Admin",message:e.message_text})));u(s)})).catch((e=>{console.error("Error fetching messages: ",e)}));const e=(new a.$).withUrl(`${c.T}/chathub?user_name=${p}`).withAutomaticReconnect().build();return e.start().then((()=>{console.log("SignalR Connected!"),m(!0)})).catch((e=>{console.error("Connection Error: ",e),m(!1)})),e.on("ReceiveMessage",((e,s)=>{u((t=>[...t,{user:e,message:s}]))})),s(e),()=>{e.stop()}}}catch{}}),[p]),(0,r.useEffect)((()=>{var e;null===(e=C.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[t]);const k=async s=>{if(s.preventDefault(),!e||!d.trim())return;const t={user:"user",message:d};g("");try{await n.A.post(`${c.T}/api/MessageUser/send-message-user`,{username:w.username,password:w.password,messageText:d}),u((e=>[...e,t]))}catch{}try{await e.invoke("SendMessage",p,d)}catch(a){console.error("Error sending message: ",a)}},A=()=>{v((e=>!e))};return(0,l.jsxs)("div",{className:"user-chat",children:[(0,l.jsxs)("span",{onClick:A,className:"toggle-chat",children:[(0,l.jsx)(o,{})," ",(0,l.jsx)("span",{children:"\u062f\u0631\u062f\u0634\u0629 \u0645\u0628\u0627\u0634\u0631\u0629"})," "]}),j?(0,l.jsxs)("form",{onSubmit:k,children:[(0,l.jsxs)("h2",{children:["   ",(0,l.jsx)("span",{children:" \u062f\u0631\u062f\u0634\u0629 \u0645\u0639 \u0627\u0644\u062f\u0639\u0645 \u0627\u0644\u0641\u0646\u064a"}),(0,l.jsxs)("span",{onClick:A,children:[" ",(0,l.jsx)(h.A,{})]})]}),(0,l.jsxs)("ul",{children:[t.map(((e,s)=>(0,l.jsx)("li",{className:"Admin"===e.user?"left":"right",children:(0,l.jsx)("span",{children:e.message})},s))),(0,l.jsx)("div",{ref:C})]}),(0,l.jsxs)("div",{className:"input-group-chat",children:[(0,l.jsx)("input",{type:"text",value:d,onChange:e=>g(e.target.value),placeholder:"\u0623\u0631\u0633\u0644 \u0631\u0633\u0627\u0644\u0629"}),(0,l.jsx)("button",{onClick:k,children:(0,l.jsx)(i.A,{})})]})]}):null]})}},8252:()=>{},9712:(e,s,t)=>{t.d(s,{A:()=>r});var a=t(579);const r=()=>(0,a.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("rect",{width:"40",height:"40",rx:"20",transform:"matrix(-1 0 0 1 40 0)",fill:"#81A321"}),(0,a.jsx)("path",{d:"M24.3333 20L27 28L11 20L27 12L24.3333 20ZM24.3333 20H19",stroke:"#FCFCFC","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]})}}]);
//# sourceMappingURL=82.7acdc4d7.chunk.js.map